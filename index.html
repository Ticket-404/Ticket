<!DOCTYPE html>
<html lang="ka">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>პრობლემის გაგზავნა</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      overflow: hidden;
      height: 100%;
      touch-action: none;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: #ffffff;
      color: #000000;
      line-height: 1.5;
      padding: 20px;
      min-height: 100vh;
      overflow: hidden;
      position: fixed;
      width: 100%;
      height: 100%;
      touch-action: none;
    }

    .container {
      max-width: 400px;
      margin: 0 auto;
      background: #ffffff;
      border: 2px solid #000000;
      border-radius: 0;
      max-height: calc(100vh - 40px);
      overflow-y: auto;
      position: relative;
    }

    .header {
      background: #000000;
      color: #ffffff;
      padding: 20px 20px;
      text-align: center;
      border-bottom: 2px solid #000000;
    }

    .header h1 {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 6px;
      letter-spacing: 0.5px;
    }

    .header p {
      font-size: 12px;
      font-weight: 400;
      opacity: 0.9;
    }

    .form-content {
      padding: 20px 20px;
    }

    .form-group {
      margin-bottom: 18px;
    }

    .form-group:last-child {
      margin-bottom: 0;
    }

    .form-label {
      display: block;
      font-weight: 600;
      color: #000000;
      margin-bottom: 6px;
      font-size: 13px;
    }

    .form-input,
    .form-select {
      width: 100%;
      padding: 12px;
      border: 2px solid #000000;
      border-radius: 0;
      font-size: 14px;
      background: #ffffff;
      color: #000000;
      font-family: inherit;
      font-weight: 400;
    }

    .form-input:focus,
    .form-select:focus {
      outline: none;
      border: 2px solid #000000;
      background: #f8f8f8;
      box-shadow: 0 0 0 2px #000000;
    }

    .form-select {
      cursor: pointer;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23000000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
      background-position: right 12px center;
      background-repeat: no-repeat;
      background-size: 14px;
      padding-right: 35px;
      appearance: none;
    }

    .form-input::placeholder {
      color: #666666;
      font-style: italic;
    }

    .other-problem {
      max-height: 0;
      overflow: hidden;
      opacity: 0;
    }

    .other-problem.show {
      max-height: 150px;
      opacity: 1;
      margin-top: 15px;
    }

    .submit-button {
      width: 100%;
      background: #000000;
      color: #ffffff;
      border: 2px solid #000000;
      padding: 14px 16px;
      border-radius: 0;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      margin-top: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .submit-button:hover {
      background: #ffffff;
      color: #000000;
      border: 2px solid #000000;
    }

    .submit-button:active {
      background: #f0f0f0;
    }

    .message {
      padding: 15px;
      margin-bottom: 18px;
      font-weight: 600;
      text-align: center;
      display: none;
      border: 2px solid #000000;
      font-size: 13px;
    }

    .success-message {
      background: #ffffff;
      color: #000000;
      border: 2px solid #000000;
    }

    .error-message {
      background: #000000;
      color: #ffffff;
      border: 2px solid #000000;
    }

    .input-wrapper {
      position: relative;
    }

    .input-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 14px;
      color: #000000;
      font-weight: bold;
    }

    .input-wrapper .form-input,
    .input-wrapper .form-select {
      padding-left: 40px;
    }

    .divider {
      height: 2px;
      background: #000000;
      margin: 20px 0;
    }

    /* Mobile optimizations */
    @media (max-width: 768px) {
      body {
        padding: 12px;
      }
      
      .container {
        border: 1px solid #000000;
        max-height: calc(100vh - 24px);
      }
      
      .header {
        padding: 18px 15px;
      }
      
      .header h1 {
        font-size: 16px;
      }
      
      .header p {
        font-size: 11px;
      }
      
      .form-content {
        padding: 18px 15px;
      }
      
      .form-group {
        margin-bottom: 15px;
      }
      
      .form-input,
      .form-select {
        padding: 10px;
        font-size: 14px; /* Prevents zoom on iOS */
      }
      
      .input-wrapper .form-input,
      .input-wrapper .form-select {
        padding-left: 35px;
      }
      
      .input-icon {
        left: 10px;
        font-size: 12px;
      }
      
      .submit-button {
        padding: 12px 16px;
        font-size: 13px;
      }
      
      .message {
        padding: 12px;
        font-size: 12px;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 8px;
      }
      
      .container {
        max-height: calc(100vh - 16px);
      }
      
      .header {
        padding: 15px 12px;
      }
      
      .form-content {
        padding: 15px 12px;
      }
      
      .form-input,
      .form-select {
        padding: 8px;
      }
      
      .input-wrapper .form-input,
      .input-wrapper .form-select {
        padding-left: 32px;
      }
      
      .input-icon {
        left: 8px;
      }
    }

    /* Remove all transitions and animations */
    *,
    *::before,
    *::after {
      transition: none !important;
      animation: none !important;
    }

    /* Prevent unwanted mobile interactions */
    * {
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    /* Allow text selection only in form inputs */
    .form-input,
    .form-select {
      -webkit-user-select: text;
      -moz-user-select: text;
      -ms-user-select: text;
      user-select: text;
    }

    /* Ensure proper form styling */
    input[type="text"],
    input[type="tel"],
    select {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
    }

    /* iOS specific fixes */
    @supports (-webkit-touch-callout: none) {
      .form-input,
      .form-select {
        font-size: 16px; /* Prevents zoom */
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>პრობლემის გაგზავნა</h1>
      <p>შეავსეთ ყველა საჭირო ველი</p>
    </div>
    
    <div class="form-content">
      <div class="success-message message" id="successMessage">
        ✓ თქვენი პრობლემა წარმატებით გაიგზავნა!
      </div>
      
      <div class="error-message message" id="errorMessage">
        ✗ შეცდომა მოხდა გაგზავნისას. გთხოვთ სცადოთ თავიდან.
      </div>

      <form id="problemForm">
        <div class="form-group">
          <label for="name" class="form-label">სრული სახელი</label>
          <div class="input-wrapper">
            <span class="input-icon">👤</span>
            <input type="text" id="name" class="form-input" placeholder="შეიყვანეთ სახელი და გვარი" required>
          </div>
        </div>

        <div class="form-group">
          <label for="phone" class="form-label">ტელეფონის ნომერი</label>
          <div class="input-wrapper">
            <span class="input-icon">📞</span>
            <input type="tel" id="phone" class="form-input" placeholder="+995 5XX XXX XXX" required>
          </div>
        </div>

        <div class="form-group">
          <label for="location" class="form-label">ლოკაცია</label>
          <div class="input-wrapper">
            <span class="input-icon">📍</span>
            <select id="location" class="form-select" required>
              <option value="">აირჩიეთ ლოკაცია</option>
              <option value="Abashidze">Abashidze</option>
              <option value="Abashidze container">Abashidze container</option>
              <option value="Paliashvili">Paliashvili</option>
              <option value="M2">M2</option>
              <option value="Bukia">Bukia</option>
              <option value="Beliashvili">Beliashvili</option>
              <option value="Agmashenebeli">Agmashenebeli</option>
              <option value="Rustavi">Rustavi</option>
              <option value="Lisi Lake">Lisi Lake</option>
              <option value="Turtle Lake">Turtle Lake</option>
              <option value="Deda Ena">Deda Ena</option>
              <option value="East Point">East Point</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="question" class="form-label">პრობლემის ტიპი</label>
          <div class="input-wrapper">
            <span class="input-icon">❓</span>
            <select id="question" class="form-select" required>
              <option value="">აირჩიეთ პრობლემა</option>
              <option value="ინტერნეტი არ მუშაობს">ინტერნეტი არ მუშაობს</option>
              <option value="შოფიფაი ჭედავს">შოფიფაი ჭედავს</option>
              <option value="ფასები არასწორია">ფასები არასწორია</option>
              <option value="სხვა ტექნიკური პრობლემა">სხვა ტექნიკური პრობლემა</option>
            </select>
          </div>
        </div>

        <div id="otherProblemDiv" class="other-problem">
          <div class="form-group">
            <label for="otherProblem" class="form-label">პრობლემის აღწერა</label>
            <input type="text" id="otherProblem" class="form-input" placeholder="აღწერეთ პრობლემა დეტალურად">
          </div>
        </div>

        <div class="divider"></div>

        <button type="submit" class="submit-button">
          გაგზავნა
        </button>
      </form>
    </div>
  </div>

  <script>
    // Webhook URLs mapping for each location
    const webhookUrls = {
      "East Point": "https://chat.googleapis.com/v1/spaces/AAQAV41Bxrs/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=coQjqN3b_q9q1QRMrJJDiRmdZPPnsuuUXZtm2CD_nig",
      "Rustavi": "https://chat.googleapis.com/v1/spaces/AAQAfAd94-o/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=ihXXVvGfJJIJCxDtxXmYiVcoP63gxGWp6cjV1YVHca4",
      "Deda Ena": "https://chat.googleapis.com/v1/spaces/AAQAvasgk4E/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=9ZvEgAuB4tWU_-BsZ-lrgQe5UtKmF95h78qZ-Rbx82o",
      "Agmashenebeli": "https://chat.googleapis.com/v1/spaces/AAQAKBlPT9I/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=6FQNsiR4qMngESMiZnBhl5nVnvPtcOxl9-Ubiuj61ys",
      "Beliashvili": "https://chat.googleapis.com/v1/spaces/AAQAT-26aSc/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=ECND1a8uPRU2ZcNjUy33gu18LYLflwGfTd7K3e1FBLc",
      "Paliashvili": "https://chat.googleapis.com/v1/spaces/AAQAkmM_mME/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=5kDgNlD2oqfJX4sfNwOPlvFvmuD206U3TCBdsYDW_iE",
      "Abashidze container": "https://chat.googleapis.com/v1/spaces/AAQA1Ol2Af8/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=dZl1s0TwTNMdKKksE1IEtsOw0VhjkIh33qE5yHCc3LI",
      "Abashidze": "https://chat.googleapis.com/v1/spaces/AAQAA69rmqM/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=NWp1gGm0IrOro_AD0JxM8bSSErnCvDCdSv-PWTxO-uY",
      "Turtle Lake": "https://chat.googleapis.com/v1/spaces/AAQA2lG1BPY/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=FpAcsIAMw-kwUkS-fQRYuxhYXLxCMuzY5INFoV9JPHs",
      "Lisi Lake": "https://chat.googleapis.com/v1/spaces/AAQAQFUbi38/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=GPQzOQzCUm9yIFIlNadJRPAhRXU6uEJ7AUFlSARoaB8",
      "M2": "https://chat.googleapis.com/v1/spaces/AAQA-H2zh2g/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=R_yo60mbgu-VGWsVMOdZVeiQVuWS9MVQEiV3_fYcWvQ",
      "Bukia": "https://chat.googleapis.com/v1/spaces/AAQAjX1ETLY/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=RTpdha1BqoH8mwxgyXESfICLnKHerS-m5o-kdqwXiJM"
    };

    const questionSelect = document.getElementById("question");
    const otherDiv = document.getElementById("otherProblemDiv");
    const otherInput = document.getElementById("otherProblem");
    const form = document.getElementById("problemForm");
    const successMessage = document.getElementById("successMessage");
    const errorMessage = document.getElementById("errorMessage");

    questionSelect.addEventListener("change", () => {
      if (questionSelect.value === "სხვა ტექნიკური პრობლემა") {
        otherDiv.classList.add("show");
        otherInput.required = true;
      } else {
        otherDiv.classList.remove("show");
        otherInput.value = "";
        otherInput.required = false;
      }
    });

    function showMessage(element, duration = 4000) {
      element.style.display = "block";
      setTimeout(() => {
        element.style.display = "none";
      }, duration);
    }

    async function sendMessage(event) {
      event.preventDefault();
      
      const name = document.getElementById("name").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const location = document.getElementById("location").value.trim();
      let question = document.getElementById("question").value.trim();
      const other = otherInput.value.trim();

      if (!name || !phone || !location || !question) {
        showMessage(errorMessage);
        return;
      }

      // Get the webhook URL for the selected location
      const webhookUrl = webhookUrls[location];
      
      if (!webhookUrl) {
        console.error("No webhook URL found for location:", location);
        showMessage(errorMessage);
        return;
      }

      if (question === "სხვა ტექნიკური პრობლემა" && other) {
        question = `სხვა პრობლემა: ${other}`;
      }

      let fullMessage = `📩 ახალი შეტყობინება:\n\n👤 მომხმარებელი: ${name}\n📞 ნომერი: ${phone}\n📍 ლოკაცია: ${location}\n❓ პრობლემა: ${question}`;

      // Add problem-specific help
      if (question.includes("ინტერნეტი არ მუშაობს")) {
        fullMessage += `\n\n🔧 ტექნიკური დახმარება - ინტერნეტის პრობლემის მოგვარება:\n📋 გთხოვთ შეამოწმოთ შემდეგი:\n1️⃣ დაათვალიერეთ თეთრი ყუთი (როუტერი) - მწვანეა თუ არა WiFi სიმბოლო?\n2️⃣ რომელი სხვა სიმბოლოები ანათებს მწვანედ?\n3️⃣ სცადეთ როუტერის კვების კაბელის ამოღება და ხელახლა ჩართვა (30 წამით გამორთეთ)\n4️⃣ სცადეთ ლოკაციის ელექტროენერგიის მთლიანად გამორთვა და ხელახლა ჩართვა\n5️⃣ დაელოდეთ 2-3 წუთი და შეამოწმეთ ხელახლა\n❓ ამ ნაბიჯების შემდეგ კვლავ გრძელდება პრობლემა?\n\n📞 ტექნიკური მხარდაჭერა - საკონტაქტო ნომრები:\nთუ პრობლემა კვლავ გრძელდება, დაუკავშირდით:\n👨‍💼 ლუკა კანდელაკი\n📱 +995551198974\n👨‍💼 გივიკო ადუაშვილი\n📱 +995555133711`;
      } else if (question.includes("შოფიფაი ჭედავს")) {
        fullMessage += `\n\n🛒 შოფიფაი ჭედავს - დახმარება:\n📹 გთხოვთ გამოგვიგზავნოთ ვიდეო თუ როგორ ჭედავს შოფიფაი\n🔍 ასევე შეამოწმეთ:\n🔴 ჩანს თუ არა წითელი ზოლი გვერდის ზემოთ? - ეს ნიშნავს ინტერნეტის პრობლემას\n📶 შეამოწმეთ ინტერნეტის კავშირი\n🔄 სცადეთ გვერდის განახლება (refresh)\n📱 სცადეთ სხვა მოწყობილობაზე\nთუ პრობლემა გრძელდება, ვიდეოთან ერთად მოგვწერეთ!\n\n📞 შოფიფაი მხარდაჭერა - საკონტაქტო ნომერი:\nთუ პრობლემა კვლავ გრძელდება, დაუკავშირდით:\n👨‍💼 სოსო(იოსები) ღვაბერიძე\n📱 +995591044006`;
      } else if (question.includes("ფასები არასწორია")) {
        fullMessage += `\n\n💰 ფასების შემოწმება - დახმარება:\n📋 გთხოვთ გადაამოწმოთ შემდეგი:\n1️⃣ სად ნახეთ არასწორი ფასი?\n• მონიტორის მენიუში?\n• შოფიფაი აპლიკაციაში?\n• ვოლტში (Wolt)?\n• გლოვოში (Glovo)?\n• ბოლტ ფუდში (Bolt Food)?\n• სხვა დელივერი სერვისში?\n2️⃣ რომელი პროდუქტის ფასია არასწორი?\n3️⃣ რა ფასი ჩანს და რა უნდა იყოს?\n4️⃣ გამოგვიგზავნეთ ფოტო ან სკრინშოტი ყველა პლატფორმიდან\n5️⃣ შეადარეთ: მონიტორის მენიუ ↔ შოფიფაი აპლიკაცია ↔ Wolt ↔ Glovo ↔ Bolt Food\n📸 ფოტოები ძალიან მნიშვნელოვანია ფასების სწორად გამოსასწორებლად!\n\n📞 ფასების მხარდაჭერა - საკონტაქტო ნომრები:\nფასების პრობლემის მოგვარებისთვის დაუკავშირდით:\n👨‍💼 ლუკა კანდელაკი\n📱 +995551198974\n👨‍💼 სოსო(იოსები) ღვაბერიძე\n📱 +995591044006`;
      } else if (question.includes("სხვა პრობლემა")) {
        fullMessage += `\n\n🔧 სხვა ტექნიკური პრობლემა - დეტალური დიაგნოსტიკა:\n❓ გთხოვთ გამოიკვლიოთ თქვენი პრობლემა:\n\n🌐 არის თუ არა ინტერნეტთან დაკავშირებული?\n• ჩანს თუ არა წითელი ზოლი გვერდის ზემოთ?\n• შოფიფაი ყველა ლოკაციაზე ჭედავს?\n• მონიტორის მენიუ იხსნება თუ არა?\n• ღია თუ არა ისტორია და რეპორტები?\n• მუშაობს თუ არა ღილაკები (დამატება, წაშლა, რედაქტირება)?\n\n🛒 არის თუ არა შოფიფაი/სისტემასთან დაკავშირებული?\n• რომელ გვერდზე/ღილაკზე ხდება პრობლემა?\n• გამოდის თუ არა შეცდომის შეტყობინება?\n• რა ზუსტად წერია შეცდომაში? (ფოტო გამოგვიგზავნეთ)\n• ყოველთვის ხდება თუ ზოგჯერ?\n• ყველა მოწყობილობაზე ხდება თუ მხოლოდ ერთზე?\n\n💰 არის თუ არა ფასებთან დაკავშირებული?\n• სად ნახეთ არასწორი ფასი?\n- მონიტორის მენიუში\n- შოფიფაი აპლიკაციაში\n- ვოლტში (Wolt)\n- გლოვოში (Glovo)\n- ბოლტ ფუდში (Bolt Food)\n- სხვა დელივერი სერვისებში\n• რომელი პროდუქტი?\n• რა ფასი ჩანს და რა უნდა იყოს?\n• ყველა პლატფორმაზე არასწორია თუ მხოლოდ ერთზე?\n\n📱 ტექნიკური ინფორმაცია:\n• რომელი მოწყობილობა გიყენებთ? (იფადი, ანდროიდი, ლეპტოპი)\n• რომელი ბრაუზერი? (ქრომი, საფარი, ფაიერფოქსი)\n• კონკრეტული მოწყობილობის სახელი?\n• ოპერაციული სისტემა?\n\n📸 მნიშვნელოვანი:\n• გამოგვიგზავნეთ სკრინშოტები ან ვიდეო\n• აღწერეთ რა ზუსტად ხდება\n• მოგვახსენეთ როდის დაიწყო პრობლემა\n• არის თუ არა მუდმივი თუ პერიოდული\n\n🔄 ბაზისური ნაბიჯები (სცადეთ ჯერ ეს):\n1️⃣ დახურეთ და ხელახლა გახსენით აპლიკაცია\n2️⃣ ღრმად გახსენით აპლიკაცია (Force restart)\n3️⃣ გადატვირთეთ მოწყობილობა\n4️⃣ შეამოწმეთ ინტერნეტის კავშირი\n5️⃣ სცადეთ სხვა მოწყობილობაზე\n6️⃣ დაელოდეთ 2-3 წუთს და ხელახლა სცადეთ\n\n📞 მხარდაჭერის საკონტაქტო ნომრები:\n\n🌐 ინტერნეტის პრობლემების შემთხვევაში:\n👨‍💼 ლუკა კანდელაკი - 📱 +995551198974\n👨‍💼 გივიკო ადუაშვილი - 📱 +995555133711\n\n🛒 შოფიფაი/სისტემის პრობლემების შემთხვევაში:\n👨‍💼 სოსო(იოსები) ღვაბერიძე - 📱 +995591044006\n\n💰 ფასების პრობლემების შემთხვევაში:\n👨‍💼 ლუკა კანდელაკი - 📱 +995551198974\n👨‍💼 სოსო(იოსები) ღვაბერიძე - 📱 +995591044006\n\n⚠️ მოგვწერეთ მაქსიმალურად დეტალური ინფორმაციით და ფოტოებით/ვიდეოებით!`;
      }

      const message = {
        text: fullMessage
      };

      // Show success message immediately to user
      showMessage(successMessage);
      form.reset();
      otherDiv.classList.remove("show");
      otherInput.required = false;

      try {
        // Send message to the specific location's webhook after 5 seconds
        setTimeout(async () => {
          try {
            console.log(`Sending message to ${location}:`, webhookUrl);
            const response = await fetch(webhookUrl, {
              method: "POST",
              headers: {
                "Content-Type": "application/json"
              },
              body: JSON.stringify(message)
            });
            
            if (response.ok) {
              console.log(`Message sent successfully to ${location}`);
            } else {
              console.error(`Failed to send message to ${location}:`, response.status);
            }
          } catch (error) {
            console.error(`Error sending message to ${location}:`, error);
          }
        }, 5000);
        
      } catch (error) {
        console.error("Error in message flow:", error);
      }
    }

    form.addEventListener("submit", sendMessage);
  </script>
</body>
</html>
